rho = rho,
seed = seed2+si
)
y_ct2  <- sim2$y_ct
y_trt2 <- sim2$y_trt
### Final Analysis
fa <- final_analysis(
interim = ia,
y_trt2 = y_trt2,
y_ct2  = y_ct2
)
# fa
sum_fa = dplyr::mutate(summary(fa),si)
fa_out = dplyr::bind_rows(fa_out,sum_ia)
if (fa$decision == "Reject H0 at final analysis."){
rej_ind[si] = 1
}else{
rej_ind[si] = 0
}
}
}
proportion_of_rejection = mean(rej_ind)
proportion_of_rejection
ia_out
fa_out
ia_out
dplyr::relocate(fa_out,si,1)
sum(is.na(rej_ind))
devtools::document()
devtools::load_all()
nsim <- 1e2
alpha <- 0.025
beta  <- 0.2
n_endpts <- 6
allocate_rate <- 1
mean_cohen_d_truth <- 0.25
timing_interim <- 2/3
max_ss_index <- 2
mu_ct <- c(4, 6, 4, 5, 7, 6)
sd <- c(0.5, 0.5, 1, 1, 2, 2)
rho <- matrix(c(
1.0, 0.1, 0.3, 0.7, 0.1, 0.3,
0.1, 1.0, 0.7, 0.1, 0.3, 0.7,
0.3, 0.7, 1.0, 0.1, 0.3, 0.7,
0.7, 0.1, 0.1, 1.0, 0.1, 0.3,
0.1, 0.3, 0.3, 0.1, 1.0, 0.7,
0.3, 0.7, 0.7, 0.3, 0.7, 1.0
), nrow = 6, byrow = TRUE)
SSR_type <- "SSR-Power"
global_test_type <- "exact OLS"
seed1 <- 51
seed2 <- 82
# at planning, we thought d = 0.3
exp_mean_cohen_d_at_planning <- 0.3
res <- SSRTE_simstudy(
nsim = nsim,
alpha = alpha,
beta = beta,
n_endpts = n_endpts,
allocate_rate = allocate_rate,
mean_cohen_d_truth = mean_cohen_d_truth,
mu_ct = mu_ct,
sd = sd,
rho = rho,
timing_interim = timing_interim,
initial_tot_ss = TRUE,
exp_mean_cohen_d_at_planning = exp_mean_cohen_d_at_planning,
SSR_type = SSR_type,
global_test_type = global_test_type,
max_ss_index = max_ss_index,
seed1 = seed1,
seed2 = seed2
)
res
devtools::document()
devtools::load_all()
SSR_type <- "SSR-CP"
global_test_type <- "Permutation"
nPM = 1e2
seed1 <- 51
seed2 <- 82
nsim <- 1e2
alpha <- 0.025
beta  <- 0.2
n_endpts <- 6
allocate_rate <- 1
mean_cohen_d_truth <- 0.25
timing_interim <- 2/3
max_ss_index <- 2
mu_ct <- c(4, 6, 4, 5, 7, 6)
sd <- c(0.5, 0.5, 1, 1, 2, 2)
rho <- matrix(c(
1.0, 0.1, 0.3, 0.7, 0.1, 0.3,
0.1, 1.0, 0.7, 0.1, 0.3, 0.7,
0.3, 0.7, 1.0, 0.1, 0.3, 0.7,
0.7, 0.1, 0.1, 1.0, 0.1, 0.3,
0.1, 0.3, 0.3, 0.1, 1.0, 0.7,
0.3, 0.7, 0.7, 0.3, 0.7, 1.0
), nrow = 6, byrow = TRUE)
SSR_type <- "SSR-CP"
global_test_type <- "Permutation"
nPM = 1e2
seed1 <- 51
seed2 <- 82
# at planning, we thought d = 0.3
exp_mean_cohen_d_at_planning <- 0.3
res1 <- SSRTE_simstudy(
nsim = nsim,
alpha = alpha,
beta = beta,
n_endpts = n_endpts,
allocate_rate = allocate_rate,
mean_cohen_d_truth = mean_cohen_d_truth,
mu_ct = mu_ct,
sd = sd,
rho = rho,
timing_interim = timing_interim,
initial_tot_ss = TRUE,
exp_mean_cohen_d_at_planning = exp_mean_cohen_d_at_planning,
SSR_type = SSR_type,
global_test_type = global_test_type,
max_ss_index = max_ss_index,
seed1 = seed1,
seed2 = seed2
)
res1 <- SSRTE_simstudy(
nsim = nsim,
alpha = alpha,
beta = beta,
n_endpts = n_endpts,
allocate_rate = allocate_rate,
mean_cohen_d_truth = mean_cohen_d_truth,
mu_ct = mu_ct,
sd = sd,
rho = rho,
timing_interim = timing_interim,
initial_tot_ss = TRUE,
exp_mean_cohen_d_at_planning = exp_mean_cohen_d_at_planning,
SSR_type = SSR_type,
global_test_type = global_test_type,
max_ss_index = max_ss_index,
seed1 = seed1,
seed2 = seed2,
nPM = nPM
)
res1
library(SSRTE)
?interim_analysis
?simulate_example_one_stage_data
devtools::document()
devtools::load_all()
?simulate_example_one_stage_data
devtools::document()
devtools::install()
library(SSRTE)
?simulate_example_one_stage_data
?get_efficacy_boundaries
?get_initial_tot_ss
?interim_analysis
?final_analysis
?SSRTE_simstudy
?target_CP_get_N_ct
?get_CP
?get_1_PM_mean_z_score
detach("package:SSRTE", unload = TRUE)
devtools::install()
library(SSRTE)
remove.packages("SSRTE")
.libPaths()
library(devtools)
devtools::document()   # regenerate NAMESPACE, man/ etc.
devtools::install(".") # build & install cleanly
library(SSRTE)
alpha <- 0.025
beta  <- 0.2
n_endpts <- 6
allocate_rate <- 1
mean_cohen_d_truth <- 0.25
# at planning, we thought d = 0.3
exp_mean_cohen_d_at_planning <- 0.3
exp_rho_at_planning <- diag(1-.3,n_endpts) + diag(1-.3,n_endpts)
timing_interim <- 2/3
max_ss_index <- 2
mu_ct <- c(4, 6, 4, 5, 7, 6)
sd <- c(0.5, 0.5, 1, 1, 2, 2)
rho <- matrix(c(
1.0, 0.1, 0.3, 0.7, 0.1, 0.3,
0.1, 1.0, 0.7, 0.1, 0.3, 0.7,
0.3, 0.7, 1.0, 0.1, 0.3, 0.7,
0.7, 0.1, 0.1, 1.0, 0.1, 0.3,
0.1, 0.3, 0.3, 0.1, 1.0, 0.7,
0.3, 0.7, 0.7, 0.3, 0.7, 1.0
), nrow = 6, byrow = TRUE)
SSR_type <- "SSR-CP"
global_test_type <- "Permutation"
nPM = 1e2
seed1 <- 51
seed2 <- 82
init_ss <- get_initial_tot_ss(
beta0    = beta,
r        = allocate_rate,
theta_k  = exp_mean_cohen_d_at_planning,
n_endpts = n_endpts,
alpha0   = alpha,
rho      = rho,
timing0  = timing_interim
)
N_ct <- init_ss$N_ct
n_ct <- init_ss$n_ct
N_trt <- init_ss$N_trt
n_trt <- init_ss$n_trt
timing_actual <- init_ss$timing_actual
# ------------------- 2. stage 1 data -------------------------------------
sim1 <- simulate_example_one_stage_data(
n_trt = n_trt,
n_ct  = n_ct,
n_endpts = n_endpts,
exp_mean_cohen_d = mean_cohen_d_truth,
mu_ct = mu_ct,
sd = sd,
rho = rho,
seed = seed1 + si
)
y_ct1  <- sim1$y_ct
y_trt1 <- sim1$y_trt
# ------------------- 3. interim ------------------------------------------
ia <- interim_analysis(
y_trt1 = y_trt1,
y_ct1  = y_ct1,
N_trt = N_trt,
N_ct = N_ct,
N_ct_max = max_ss_index * N_ct,
timing_actual = timing_actual,
alpha0 = alpha,
beta0 = beta,
alloc_rate = allocate_rate,
n_endpts = n_endpts,
SSR_type = SSR_type,
global_test_type = global_test_type,
nPM = nPM
)
ia
seed1 <- 13
seed2 <- 8
init_ss <- get_initial_tot_ss(
beta0    = beta,
r        = allocate_rate,
theta_k  = exp_mean_cohen_d_at_planning,
n_endpts = n_endpts,
alpha0   = alpha,
rho      = rho,
timing0  = timing_interim
)
N_ct <- init_ss$N_ct
n_ct <- init_ss$n_ct
N_trt <- init_ss$N_trt
n_trt <- init_ss$n_trt
timing_actual <- init_ss$timing_actual
# ------------------- 2. stage 1 data -------------------------------------
sim1 <- simulate_example_one_stage_data(
n_trt = n_trt,
n_ct  = n_ct,
n_endpts = n_endpts,
exp_mean_cohen_d = mean_cohen_d_truth,
mu_ct = mu_ct,
sd = sd,
rho = rho,
seed = seed1
)
y_ct1  <- sim1$y_ct
y_trt1 <- sim1$y_trt
ia <- interim_analysis(
y_trt1 = y_trt1,
y_ct1  = y_ct1,
N_trt = N_trt,
N_ct = N_ct,
N_ct_max = max_ss_index * N_ct,
timing_actual = timing_actual,
alpha0 = alpha,
beta0 = beta,
alloc_rate = allocate_rate,
n_endpts = n_endpts,
SSR_type = SSR_type,
global_test_type = global_test_type,
nPM = nPM
)
ia
alpha <- 0.025
beta  <- 0.2
n_endpts <- 6
allocate_rate <- 1
mean_cohen_d_truth <- 0.25
# at planning, we thought d = 0.3
exp_mean_cohen_d_at_planning <- 0.3
exp_rho_at_planning <- diag(1-.3,n_endpts) + diag(1-.3,n_endpts)
timing_interim <- .5
max_ss_index <- 2
mu_ct <- c(4, 6, 4, 5, 7, 6)
sd <- c(0.5, 0.5, 1, 1, 2, 2)
rho <- matrix(c(
1.0, 0.1, 0.3, 0.7, 0.1, 0.3,
0.1, 1.0, 0.7, 0.1, 0.3, 0.7,
0.3, 0.7, 1.0, 0.1, 0.3, 0.7,
0.7, 0.1, 0.1, 1.0, 0.1, 0.3,
0.1, 0.3, 0.3, 0.1, 1.0, 0.7,
0.3, 0.7, 0.7, 0.3, 0.7, 1.0
), nrow = 6, byrow = TRUE)
SSR_type <- "SSR-CP"
global_test_type <- "Permutation"
nPM = 1e2
seed1 <- 1324
seed2 <- 8
init_ss <- get_initial_tot_ss(
beta0    = beta,
r        = allocate_rate,
theta_k  = exp_mean_cohen_d_at_planning,
n_endpts = n_endpts,
alpha0   = alpha,
rho      = rho,
timing0  = timing_interim
)
N_ct <- init_ss$N_ct
n_ct <- init_ss$n_ct
N_trt <- init_ss$N_trt
n_trt <- init_ss$n_trt
timing_actual <- init_ss$timing_actual
# ------------------- 2. stage 1 data -------------------------------------
sim1 <- simulate_example_one_stage_data(
n_trt = n_trt,
n_ct  = n_ct,
n_endpts = n_endpts,
exp_mean_cohen_d = mean_cohen_d_truth,
mu_ct = mu_ct,
sd = sd,
rho = rho,
seed = seed1
)
y_ct1  <- sim1$y_ct
y_trt1 <- sim1$y_trt
ia <- interim_analysis(
y_trt1 = y_trt1,
y_ct1  = y_ct1,
N_trt = N_trt,
N_ct = N_ct,
N_ct_max = max_ss_index * N_ct,
timing_actual = timing_actual,
alpha0 = alpha,
beta0 = beta,
alloc_rate = allocate_rate,
n_endpts = n_endpts,
SSR_type = SSR_type,
global_test_type = global_test_type,
nPM = nPM
)
ia
alpha <- 0.025
beta  <- 0.2
n_endpts <- 6
allocate_rate <- 1
mean_cohen_d_truth <- 0.3
# at planning, we thought d = 0.4
exp_mean_cohen_d_at_planning <- 0.3
exp_rho_at_planning <- diag(1-.3,n_endpts) + diag(1-.3,n_endpts)
timing_interim <- .5
max_ss_index <- 2
mu_ct <- c(4, 6, 4, 5, 7, 6)
sd <- c(0.5, 0.5, 1, 1, 2, 2)
rho <- matrix(c(
1.0, 0.1, 0.3, 0.7, 0.1, 0.3,
0.1, 1.0, 0.7, 0.1, 0.3, 0.7,
0.3, 0.7, 1.0, 0.1, 0.3, 0.7,
0.7, 0.1, 0.1, 1.0, 0.1, 0.3,
0.1, 0.3, 0.3, 0.1, 1.0, 0.7,
0.3, 0.7, 0.7, 0.3, 0.7, 1.0
), nrow = 6, byrow = TRUE)
SSR_type <- "SSR-CP"
global_test_type <- "Permutation"
nPM = 1e2
seed1 <- 1324
seed2 <- 8
init_ss <- get_initial_tot_ss(
beta0    = beta,
r        = allocate_rate,
theta_k  = exp_mean_cohen_d_at_planning,
n_endpts = n_endpts,
alpha0   = alpha,
rho      = rho,
timing0  = timing_interim
)
N_ct <- init_ss$N_ct
n_ct <- init_ss$n_ct
N_trt <- init_ss$N_trt
n_trt <- init_ss$n_trt
timing_actual <- init_ss$timing_actual
# ------------------- 2. stage 1 data -------------------------------------
sim1 <- simulate_example_one_stage_data(
n_trt = n_trt,
n_ct  = n_ct,
n_endpts = n_endpts,
exp_mean_cohen_d = mean_cohen_d_truth,
mu_ct = mu_ct,
sd = sd,
rho = rho,
seed = seed1
)
y_ct1  <- sim1$y_ct
y_trt1 <- sim1$y_trt
# ------------------- 3. interim ------------------------------------------
ia <- interim_analysis(
y_trt1 = y_trt1,
y_ct1  = y_ct1,
N_trt = N_trt,
N_ct = N_ct,
N_ct_max = max_ss_index * N_ct,
timing_actual = timing_actual,
alpha0 = alpha,
beta0 = beta,
alloc_rate = allocate_rate,
n_endpts = n_endpts,
SSR_type = SSR_type,
global_test_type = global_test_type,
nPM = nPM
)
ia
n_ct2  <- ia$sample_sizes$stage2["control"]
n_trt2 <- ia$sample_sizes$stage2["treatment"]
# ------------------- 5. stage 2 data -------------------------------------
sim2 <- simulate_example_one_stage_data(
n_trt = n_trt2,
n_ct  = n_ct2,
n_endpts = n_endpts,
exp_mean_cohen_d = mean_cohen_d_truth,
mu_ct = mu_ct,
sd = sd,
rho = rho,
seed = seed2
)
y_ct2  <- sim2$y_ct
y_trt2 <- sim2$y_trt
# ------------------- 6. final --------------------------------------------
fa <- final_analysis(
interim = ia,
y_trt2  = y_trt2,
y_ct2   = y_ct2,
alloc_rate = allocate_rate
)
fa
SSR_type <- "SSR-Power"
global_test_type <- "exact OLS"#"Permutation"
ia <- interim_analysis(
y_trt1 = y_trt1,
y_ct1  = y_ct1,
N_trt = N_trt,
N_ct = N_ct,
N_ct_max = max_ss_index * N_ct,
timing_actual = timing_actual,
alpha0 = alpha,
beta0 = beta,
alloc_rate = allocate_rate,
n_endpts = n_endpts,
SSR_type = SSR_type,
global_test_type = global_test_type
)
ia
SSRTE_simstudy(
nsim = nsim,
alpha = alpha,
beta = beta,
n_endpts = n_endpts,
allocate_rate = allocate_rate,
mean_cohen_d_truth = mean_cohen_d_truth,
mu_ct = mu_ct,
sd = sd,
rho = rho,
timing_interim = timing_interim,
initial_tot_ss = TRUE,
exp_mean_cohen_d_at_planning = exp_mean_cohen_d_at_planning,
SSR_type = SSR_type,
global_test_type = global_test_type,
max_ss_index = max_ss_index,
seed1 = seed1,
seed2 = seed2,
nPM = nPM
)
?get_CP
?get_CP
library(SSRTE)
get_CP?
??
FDFAD
?get_CP
devtools::document()
devtools::load_all(".")
?get_CP
detach("package:SSRTE", unload = TRUE)
devtools::load_all()
devtools::document()
devtools::install()
library(SSRTE)
?get_CP
devtools::load_all()
?get_CP
devtools::document()
devtools::install()
help(package = "SSRTE")
library(SSRTE)
?get_1_PM_mean_z_score
?get_CP
help(package="SSRTE").
help(package="SSRTE")
citations(SSRTE)
citation(SSRTE)
