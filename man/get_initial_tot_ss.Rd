% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/get_initial_tot_ss.R
\name{get_initial_tot_ss}
\alias{get_initial_tot_ss}
\title{Get the initial planned total sample size for a multivariate trial}
\usage{
get_initial_tot_ss(beta0, r, theta_k, n_endpts, alpha0 = 0.025, rho, timing0)
}
\arguments{
\item{beta0}{Type II error rate (\eqn{\beta}). Power is \code{1 - beta0}.}

\item{r}{Allocation ratio = treatment / control. For 1:1 allocation, use 1.}

\item{theta_k}{Expected treatment effect size, i.e., expected mean Cohen’s d across all endpoints (\eqn{\bar{\theta}*}).}

\item{n_endpts}{Integer. Number of endpoints.}

\item{alpha0}{One-sided type I error rate. Default \code{0.025}.}

\item{rho}{Either a single correlation value (assumed common across all
endpoint pairs) or a \code{n_endpts x n_endpts} correlation matrix.}

\item{timing0}{Planned interim timing (information fraction) in \code{(0, 1]},
e.g. \code{0.5} for an interim at half of the total sample.}
}
\value{
A list with elements:
\describe{
\item{N_tot0}{Planned total sample size under the formula (a crude result, can be non-integer).}
\item{N_ct}{Planned \strong{control} total sample size (ceiling).}
\item{N_trt}{Planned \strong{treatment} total sample size (ceiling).}
\item{n_ct}{Control sample size at interim (rounded).}
\item{n_trt}{Treatment sample size at interim (rounded).}
\item{N_interim_actual}{Actual total sample size at interim = \code{n_ct + n_trt}.}
\item{N_total_actual}{Final total sample size = \code{N_ct + N_trt}.}
\item{timing_actual}{Actual interim fraction = \code{N_interim_actual / N_total_actual}.}
}
}
\description{
This computes the \strong{planned} total sample size under a
multivariate setting with \eqn{K} endpoints, assuming a common allocation
ratio across endpoints.
}
\details{
The formula implements Eq. (2.11) in Shi et al. (2025):

\deqn{
N_{tot,0}
  = \frac{K + 2\sum_{p<q} \rho_{pq}}{K^2}
    (1/r + 1)(1 + r)
    \left(
      \frac{z_{\alpha} + z_{\beta}}{\bar{\theta}*}
    \right)^2,
}

where \eqn{K =} \code{n_endpts}, \eqn{r} is the allocation ratio
(treatment/control), and \eqn{\bar{\theta}*} is the expected mean Cohen’s d across endpoints
}
\examples{
# 1:1 allocation, 6 endpoints, common correlation 0.3, interim at 50\%
get_initial_tot_ss(
  beta0  = 0.2,
  r      = 1,
  theta_k = 0.386,
  n_endpts = 6,
  alpha0 = 0.025,
  rho    = 0.3,
  timing0 = 0.5
)

# With a correlation matrix
rho <- matrix(c(
  1.0, 0.1, 0.3, 0.7, 0.1, 0.3,
  0.1, 1.0, 0.7, 0.1, 0.3, 0.7,
  0.3, 0.7, 1.0, 0.1, 0.3, 0.7,
  0.7, 0.1, 0.1, 1.0, 0.1, 0.3,
  0.1, 0.3, 0.3, 0.1, 1.0, 0.7,
  0.3, 0.7, 0.7, 0.3, 0.7, 1.0
), nrow = 6, byrow = TRUE)

get_initial_tot_ss(
  beta0  = 0.2,
  r      = 1,
  theta_k = 0.386,
  n_endpts = 6,
  alpha0 = 0.025,
  rho    = rho,
  timing0 = 0.5
)

}
